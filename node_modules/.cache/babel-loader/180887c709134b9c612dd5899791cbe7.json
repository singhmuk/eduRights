{"ast":null,"code":"import _classCallCheck from\"/home/mukeshs/Projects/edurights/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/mukeshs/Projects/edurights/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/mukeshs/Projects/edurights/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/mukeshs/Projects/edurights/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/mukeshs/Projects/edurights/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import Prism from\"prismjs\";import{Grid,Paper,withStyles,List}from\"@material-ui/core\";import'../../ReactJs/styles.css';import Sidebar from'../sidebar';import PrismCode from'../../ReactJs/prismCode';var titles={backgroundColor:'#F0F8FF',padding:'1px',fontSize:'16px'};var styles=function styles(theme){return{paper:{margin:theme.spacing(1),padding:theme.spacing(1)},smMargin:{margin:theme.spacing(1)},actionDiv:{textAlign:\"center\"}};};var childsFile=\"\\nimport numpy as np\\nimport pandas as pd\\nfrom matplotlib import pyplot as plt\\n%matplotlib inline\\n\\ndf = pd.read_csv(\\\"customer_churn.csv\\\")\\n\\ndf.drop('customerID',axis='columns',inplace=True)\\ndf.dtypes\\n\".trim();var realize=\"\\ndf.TotalCharges.values\\npd.to_numeric(df.TotalCharges)                                                   #string Convert it to numbers.\\n\\npd.to_numeric(df.TotalCharges,errors='coerce').isnull()                          #some values not numbers but blank string.\\n\\ndf[pd.to_numeric(df.TotalCharges,errors='coerce').isnull()]\\ndf.iloc[488].TotalCharges\\ndf[df.TotalCharges!=' '].shape\\n\\ndf1 = df[df.TotalCharges!=' ']                                                   #Remove rows with space in TotalCharges.\\ndf1.TotalCharges = pd.to_numeric(df1.TotalCharges)\\ndf1.TotalCharges.values\\ndf1[df1.Churn=='No']\\n\".trim();var visualization=\"\\ntenure_churn_no = df1[df1.Churn=='No'].tenure\\ntenure_churn_yes = df1[df1.Churn=='Yes'].tenure\\n\\nplt.xlabel(\\\"tenure\\\")\\nplt.ylabel(\\\"Number Of Customers\\\")\\nplt.title(\\\"Customer Churn Prediction Visualiztion\\\")\\n\\nblood_sugar_men = [113, 85, 90, 150, 149, 88, 93, 115, 135, 80, 77, 82, 129]\\nblood_sugar_women = [67, 98, 89, 120, 133, 150, 84, 69, 89, 79, 120, 112, 100]\\n\\nplt.hist([tenure_churn_yes, tenure_churn_no], rwidth=0.95, color=['green','red'],label=['Churn=Yes','Churn=No'])\\nplt.legend()\\n\\n\\nmc_churn_no = df1[df1.Churn=='No'].MonthlyCharges      \\nmc_churn_yes = df1[df1.Churn=='Yes'].MonthlyCharges      \\n\\nplt.xlabel(\\\"Monthly Charges\\\")\\nplt.ylabel(\\\"Number Of Customers\\\")\\nplt.title(\\\"Customer Churn Prediction Visualiztion\\\")\\n\\nblood_sugar_men = [113, 85, 90, 150, 149, 88, 93, 115, 135, 80, 77, 82, 129]\\nblood_sugar_women = [67, 98, 89, 120, 133, 150, 84, 69, 89, 79, 120, 112, 100]\\n\\nplt.hist([mc_churn_yes, mc_churn_no], rwidth=0.95, color=['green','red'],label=['Churn=Yes','Churn=No'])\\nplt.legend()\\n\".trim();var columns=\"\\ndef print_unique_col_values(df):\\n       for column in df:\\n            if df[column].dtypes=='object':\\n                print(f'{column}: {df[column].unique()}') \\n                \\nprint_unique_col_values(df1)\\n\\n#Some columns have no internet service or no phone service, that can be replaced with No.\\ndf1.replace('No internet service','No',inplace=True)\\ndf1.replace('No phone service','No',inplace=True)\\n\\nprint_unique_col_values(df1)\\n\".trim();var convert=\"\\nyes_no_columns = ['Partner','Dependents','PhoneService','MultipleLines','OnlineSecurity','OnlineBackup',\\n                  'DeviceProtection','TechSupport','StreamingTV','StreamingMovies','PaperlessBilling','Churn']\\n                  \\nfor col in yes_no_columns:\\n    df1[col].replace({'Yes': 1,'No': 0},inplace=True)\\n    \\nfor col in df1:\\n    print(f'{col}: {df1[col].unique()}') \\n    \\ndf1['gender'].replace({'Female':1,'Male':0},inplace=True)\\ndf1.gender.unique()\\n\".trim();var encoding=\"\\nfrom sklearn.preprocessing import MinMaxScaler\\n\\ndf2 = pd.get_dummies(data=df1, columns=['InternetService','Contract','PaymentMethod'])\\ndf2.columns\\n\\ncols_to_scale = ['tenure','MonthlyCharges','TotalCharges']\\n\\nscaler = MinMaxScaler()\\ndf2[cols_to_scale] = scaler.fit_transform(df2[cols_to_scale])\\n\\nfor col in df2:\\n    print(f'{col}: {df2[col].unique()}')\\n\".trim();var split=\"\\nfrom sklearn.model_selection import train_test_split\\n\\nX = df2.drop('Churn',axis='columns')\\ny = df2['Churn']\\n\\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2,random_state=5)\\nlen(X_train.columns)\\n\".trim();var tensorflow=\"\\nimport tensorflow as tf\\nfrom tensorflow import keras\\n\\nmodel = keras.Sequential([\\n    keras.layers.Dense(26, input_shape=(26,), activation='relu'),\\n    keras.layers.Dense(15, activation='relu'),\\n    keras.layers.Dense(1, activation='sigmoid')\\n])\\n\\n# opt = keras.optimizers.Adam(learning_rate=0.01)\\n\\nmodel.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])\\nmodel.fit(X_train, y_train, epochs=100)\\n\\nmodel.evaluate(X_test, y_test)\\n\\nyp = model.predict(X_test)\\nyp[:5]\\n\".trim();var compiles=\"\\ny_pred = []\\nfor element in yp:\\n    if element > 0.5:\\n        y_pred.append(1)\\n    else:\\n        y_pred.append(0)\\n        \\n        \\ny_pred[:10]\\ny_test[:10]\\n\\n\\nfrom sklearn.metrics import confusion_matrix , classification_report\\nprint(classification_report(y_test,y_pred))\\n\\nimport seaborn as sn\\ncm = tf.math.confusion_matrix(labels=y_test,predictions=y_pred)\\n\\nplt.figure(figsize = (10,7))\\nsn.heatmap(cm, annot=True, fmt='d')\\nplt.xlabel('Predicted')\\nplt.ylabel('Truth')\\n\\ny_test.shape\\nround((862+229)/(862+229+137+179),2)                      #Accuracy\\n\".trim();var precision=\"\\nround(862/(862+179),2)\\nround(229/(229+137),2)                             #Precision for 1 class. i.e.Precision for customers who actually churned.\\n\\nround(229/(229+137),2)\\nround(862/(862+137),2)                             #Recall for 0 class.\\n\\nround(862/(862+137),2)\\nround(229/(229+179),2)\\n\".trim();var childsFiles=\"\\nfrom matplotlib import pyplot as plt\\nfrom sklearn.metrics import confusion_matrix , classification_report\\nimport pandas as pd\\n\\ntruth = [\\\"Dog\\\",\\\"Not a dog\\\",\\\"Dog\\\",\\\"Dog\\\", \\\"Dog\\\", \\\"Not a dog\\\", \\\"Not a dog\\\", \\\"Dog\\\", \\\"Dog\\\", \\\"Not a dog\\\"]\\nprediction = [\\\"Dog\\\",\\\"Dog\\\", \\\"Dog\\\",\\\"Not a dog\\\",\\\"Dog\\\", \\\"Not a dog\\\", \\\"Dog\\\", \\\"Not a dog\\\", \\\"Dog\\\", \\\"Dog\\\"]\\n\\ncm = confusion_matrix(truth,prediction)\\nprint_confusion_matrix(cm,[\\\"Dog\\\",\\\"Not a dog\\\"])\\n\\nprint(classification_report(truth, prediction))\\n\\n2*(0.57*0.67/(0.57+0.67))                                                                 #f1 score for Dog class.\\n2*(0.33*0.25/(0.33+0.25))                                                                 #f1 score for Not a dog class.\\n\".trim();var predictions=\"\\nPrecision =  True Positive(TP)/ (TP+FP)\\n\\nRecall = TP/ (TP + FN)\\n\".trim();var Customer=/*#__PURE__*/function(_Component){_inherits(Customer,_Component);function Customer(){_classCallCheck(this,Customer);return _possibleConstructorReturn(this,_getPrototypeOf(Customer).apply(this,arguments));}_createClass(Customer,[{key:\"componentDidMount\",value:function componentDidMount(){setTimeout(function(){return Prism.highlightAll();},0);}},{key:\"render\",value:function render(){var classes=this.props.classes;return React.createElement(Grid,{container:true},React.createElement(Grid,{item:true,xs:2},React.createElement(Paper,{className:classes.paper},React.createElement(\"h4\",null,React.createElement(Sidebar,null)))),React.createElement(Grid,{item:true,xs:10},React.createElement(Paper,{className:classes.paper},React.createElement(List,null,React.createElement(\"h3\",null,\"Customer Churn Prediction Using Artificial Neural Network (ANN)\"),\"Neural networks/ ANNs/ simulated neural networks (SNNs), are a subset of ML and are at the heart of DL algorithms. Their name and structure are inspired by the human brain, mimicking the way that biological neurons signal to one another.\",React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"i\",null,\"Customer churn prediction is to measure why customers are leaving a business. we look customer churn in telecom business. We will build a deep learning model to predict the churn and use precision,recall, f1-score to measure performance of our model.\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:childsFile,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"b\",null,\"Quick glance at above makes me realize that TotalCharges should be float but it is an object.\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:realize,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"h3\",null,\"Data Visualization\"),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:visualization,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"h3\",null,\"Many of the columns are yes, no etc. Print unique values in object columns to see data values\"),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:columns,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"h3\",null,\"Convert Yes and No to 1 or 0\"),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:convert,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"h3\",null,\"One hot encoding for categorical columns\"),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:encoding,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"h3\",null,\"Train test split\"),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:split,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"h3\",null,\"Build a model (ANN) in tensorflow/keras\"),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:tensorflow,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"b\",null,\"Precision for 0 class. i.e. Precision for customers who did not churn.\"),React.createElement(\"br\",null),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:precision,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"h3\",null),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:tensorflow,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"h3\",null,\"Precision Recall\"),React.createElement(\"ul\",null,React.createElement(\"li\",null,React.createElement(\"b\",null,\"Precision:\"),\"Is out of all Prediction how many got it right.\"),React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Think about Prediction as base.\")),React.createElement(\"br\",null),React.createElement(\"li\",null,React.createElement(\"b\",null,\"Recall:\"),\"Is out of all True how many got it right.\"),React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Think about truth is base.\"))),React.createElement(\"br\",null),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:predictions,language:\"js\",plugins:[\"line-numbers\"]})),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"div\",{style:titles},React.createElement(PrismCode,{code:childsFiles,language:\"js\",plugins:[\"line-numbers\"]}))))));}}]);return Customer;}(Component);export default withStyles(styles)(Customer);","map":{"version":3,"sources":["/home/mukeshs/Projects/edurights/src/components/angularjs/deepAngularjs/customer.js"],"names":["React","Component","Prism","Grid","Paper","withStyles","List","Sidebar","PrismCode","titles","backgroundColor","padding","fontSize","styles","theme","paper","margin","spacing","smMargin","actionDiv","textAlign","childsFile","trim","realize","visualization","columns","convert","encoding","split","tensorflow","compiles","precision","childsFiles","predictions","Customer","setTimeout","highlightAll","classes","props"],"mappings":"6kBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,CACA,OAASC,IAAT,CAAeC,KAAf,CAAsBC,UAAtB,CAAkCC,IAAlC,KAA8C,mBAA9C,CAEA,MAAO,0BAAP,CACA,MAAOC,CAAAA,OAAP,KAAoB,YAApB,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CAGA,GAAMC,CAAAA,MAAM,CAAG,CAAEC,eAAe,CAAE,SAAnB,CAA8BC,OAAO,CAAE,KAAvC,CAA8CC,QAAQ,CAAE,MAAxD,CAAf,CAEA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAAAC,KAAK,QAAK,CACvBC,KAAK,CAAE,CACLC,MAAM,CAAEF,KAAK,CAACG,OAAN,CAAc,CAAd,CADH,CAELN,OAAO,CAAEG,KAAK,CAACG,OAAN,CAAc,CAAd,CAFJ,CADgB,CAKvBC,QAAQ,CAAE,CACRF,MAAM,CAAEF,KAAK,CAACG,OAAN,CAAc,CAAd,CADA,CALa,CAQvBE,SAAS,CAAE,CACTC,SAAS,CAAE,QADF,CARY,CAAL,EAApB,CAcA,GAAMC,CAAAA,UAAU,CAAG,oNAUjBC,IAViB,EAAnB,CAYA,GAAMC,CAAAA,OAAO,CAAG,umBAcdD,IAdc,EAAhB,CAgBA,GAAME,CAAAA,aAAa,CAAG,8gCA2BpBF,IA3BoB,EAAtB,CA6BA,GAAMG,CAAAA,OAAO,CAAG,gcAadH,IAbc,EAAhB,CAeA,GAAMI,CAAAA,OAAO,CAAG,8dAYdJ,IAZc,EAAhB,CAcA,GAAMK,CAAAA,QAAQ,CAAG,iXAafL,IAbe,EAAjB,CAeA,GAAMM,CAAAA,KAAK,CAAG,oOAQZN,IARY,EAAd,CAUA,GAAMO,CAAAA,UAAU,CAAG,6fAmBjBP,IAnBiB,EAAnB,CAqBA,GAAMQ,CAAAA,QAAQ,CAAG,kkBA0BfR,IA1Be,EAAjB,CA4BA,GAAMS,CAAAA,SAAS,CAAG,gTAShBT,IATgB,EAAlB,CAWA,GAAMU,CAAAA,WAAW,CAAG,2vBAelBV,IAfkB,EAApB,CAiBA,GAAMW,CAAAA,WAAW,CAAG,wEAIlBX,IAJkB,EAApB,C,GAOMY,CAAAA,Q,gSACgB,CAClBC,UAAU,CAAC,iBAAMjC,CAAAA,KAAK,CAACkC,YAAN,EAAN,EAAD,CAA6B,CAA7B,CAAV,CACD,C,uCACQ,IACCC,CAAAA,OADD,CACa,KAAKC,KADlB,CACCD,OADD,CAEP,MACE,qBAAC,IAAD,EAAM,SAAS,KAAf,EACE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,EACE,oBAAC,KAAD,EAAO,SAAS,CAAEA,OAAO,CAACtB,KAA1B,EACE,8BAAI,oBAAC,OAAD,MAAJ,CADF,CADF,CADF,CAME,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,EACE,oBAAC,KAAD,EAAO,SAAS,CAAEsB,OAAO,CAACtB,KAA1B,EACE,oBAAC,IAAD,MACE,gGADF,iPAKE,8BALF,CAME,8BANF,CAOE,0RAPF,CAUE,8BAVF,CAWE,8BAXF,CAYE,2BAAK,KAAK,CAAEN,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEY,UADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CAZF,CAmBE,8BAnBF,CAoBE,8BApBF,CAsBE,6HAtBF,CAuBE,8BAvBF,CAwBE,8BAxBF,CAyBE,2BAAK,KAAK,CAAEZ,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEc,OADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CAzBF,CAgCE,8BAhCF,CAkCE,mDAlCF,CAmCE,2BAAK,KAAK,CAAEd,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEe,aADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CAnCF,CA0CE,8BA1CF,CA4CE,8HA5CF,CA6CE,2BAAK,KAAK,CAAEf,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEgB,OADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CA7CF,CAoDE,8BApDF,CAsDE,6DAtDF,CAuDE,2BAAK,KAAK,CAAEhB,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEiB,OADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CAvDF,CA8DE,8BA9DF,CAgEE,yEAhEF,CAiEE,2BAAK,KAAK,CAAEjB,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEkB,QADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CAjEF,CAwEE,8BAxEF,CA0EE,iDA1EF,CA2EE,2BAAK,KAAK,CAAElB,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEmB,KADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CA3EF,CAkFE,8BAlFF,CAoFE,wEApFF,CAqFE,2BAAK,KAAK,CAAEnB,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEoB,UADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CArFF,CA4FE,8BA5FF,CA6FE,8BA7FF,CA+FE,sGA/FF,CAgGE,8BAhGF,CAiGE,2BAAK,KAAK,CAAEpB,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEsB,SADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CAjGF,CAwGE,8BAxGF,CA0GE,8BA1GF,CA2GE,2BAAK,KAAK,CAAEtB,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEoB,UADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CA3GF,CAkHE,8BAlHF,CAoHE,iDApHF,CAqHE,8BACE,8BAAI,0CAAJ,mDADF,CAEE,8BACE,gEADF,CAFF,CAKE,8BALF,CAME,8BAAI,uCAAJ,6CANF,CAOE,8BACE,2DADF,CAPF,CArHF,CAgIE,8BAhIF,CAiIE,2BAAK,KAAK,CAAEpB,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEwB,WADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CAjIF,CAwIE,8BAxIF,CAyIE,8BAzIF,CA2IE,2BAAK,KAAK,CAAExB,MAAZ,EACE,oBAAC,SAAD,EACE,IAAI,CAAEuB,WADR,CAEE,QAAQ,CAAC,IAFX,CAGE,OAAO,CAAE,CAAC,cAAD,CAHX,EADF,CA3IF,CADF,CADF,CANF,CADF,CAgKD,C,sBAtKoB/B,S,EA0KvB,cAAgBI,CAAAA,UAAU,CAACQ,MAAD,CAAV,CAAmBqB,QAAnB,CAAhB","sourcesContent":["import React, { Component } from 'react';\nimport Prism from \"prismjs\"\nimport { Grid, Paper, withStyles, List } from \"@material-ui/core\";\n\nimport '../../ReactJs/styles.css'\nimport Sidebar from '../sidebar';\nimport PrismCode from '../../ReactJs/prismCode';\n\n\nconst titles = { backgroundColor: '#F0F8FF', padding: '1px', fontSize: '16px' }\n\nconst styles = theme => ({\n  paper: {\n    margin: theme.spacing(1),\n    padding: theme.spacing(1)\n  },\n  smMargin: {\n    margin: theme.spacing(1)\n  },\n  actionDiv: {\n    textAlign: \"center\"\n  }\n})\n\n\nconst childsFile = `\nimport numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\n%matplotlib inline\n\ndf = pd.read_csv(\"customer_churn.csv\")\n\ndf.drop('customerID',axis='columns',inplace=True)\ndf.dtypes\n`.trim();\n\nconst realize = `\ndf.TotalCharges.values\npd.to_numeric(df.TotalCharges)                                                   #string Convert it to numbers.\n\npd.to_numeric(df.TotalCharges,errors='coerce').isnull()                          #some values not numbers but blank string.\n\ndf[pd.to_numeric(df.TotalCharges,errors='coerce').isnull()]\ndf.iloc[488].TotalCharges\ndf[df.TotalCharges!=' '].shape\n\ndf1 = df[df.TotalCharges!=' ']                                                   #Remove rows with space in TotalCharges.\ndf1.TotalCharges = pd.to_numeric(df1.TotalCharges)\ndf1.TotalCharges.values\ndf1[df1.Churn=='No']\n`.trim();\n\nconst visualization = `\ntenure_churn_no = df1[df1.Churn=='No'].tenure\ntenure_churn_yes = df1[df1.Churn=='Yes'].tenure\n\nplt.xlabel(\"tenure\")\nplt.ylabel(\"Number Of Customers\")\nplt.title(\"Customer Churn Prediction Visualiztion\")\n\nblood_sugar_men = [113, 85, 90, 150, 149, 88, 93, 115, 135, 80, 77, 82, 129]\nblood_sugar_women = [67, 98, 89, 120, 133, 150, 84, 69, 89, 79, 120, 112, 100]\n\nplt.hist([tenure_churn_yes, tenure_churn_no], rwidth=0.95, color=['green','red'],label=['Churn=Yes','Churn=No'])\nplt.legend()\n\n\nmc_churn_no = df1[df1.Churn=='No'].MonthlyCharges      \nmc_churn_yes = df1[df1.Churn=='Yes'].MonthlyCharges      \n\nplt.xlabel(\"Monthly Charges\")\nplt.ylabel(\"Number Of Customers\")\nplt.title(\"Customer Churn Prediction Visualiztion\")\n\nblood_sugar_men = [113, 85, 90, 150, 149, 88, 93, 115, 135, 80, 77, 82, 129]\nblood_sugar_women = [67, 98, 89, 120, 133, 150, 84, 69, 89, 79, 120, 112, 100]\n\nplt.hist([mc_churn_yes, mc_churn_no], rwidth=0.95, color=['green','red'],label=['Churn=Yes','Churn=No'])\nplt.legend()\n`.trim();\n\nconst columns = `\ndef print_unique_col_values(df):\n       for column in df:\n            if df[column].dtypes=='object':\n                print(f'{column}: {df[column].unique()}') \n                \nprint_unique_col_values(df1)\n\n#Some columns have no internet service or no phone service, that can be replaced with No.\ndf1.replace('No internet service','No',inplace=True)\ndf1.replace('No phone service','No',inplace=True)\n\nprint_unique_col_values(df1)\n`.trim();\n\nconst convert = `\nyes_no_columns = ['Partner','Dependents','PhoneService','MultipleLines','OnlineSecurity','OnlineBackup',\n                  'DeviceProtection','TechSupport','StreamingTV','StreamingMovies','PaperlessBilling','Churn']\n                  \nfor col in yes_no_columns:\n    df1[col].replace({'Yes': 1,'No': 0},inplace=True)\n    \nfor col in df1:\n    print(f'{col}: {df1[col].unique()}') \n    \ndf1['gender'].replace({'Female':1,'Male':0},inplace=True)\ndf1.gender.unique()\n`.trim();\n\nconst encoding = `\nfrom sklearn.preprocessing import MinMaxScaler\n\ndf2 = pd.get_dummies(data=df1, columns=['InternetService','Contract','PaymentMethod'])\ndf2.columns\n\ncols_to_scale = ['tenure','MonthlyCharges','TotalCharges']\n\nscaler = MinMaxScaler()\ndf2[cols_to_scale] = scaler.fit_transform(df2[cols_to_scale])\n\nfor col in df2:\n    print(f'{col}: {df2[col].unique()}')\n`.trim();\n\nconst split = `\nfrom sklearn.model_selection import train_test_split\n\nX = df2.drop('Churn',axis='columns')\ny = df2['Churn']\n\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2,random_state=5)\nlen(X_train.columns)\n`.trim();\n\nconst tensorflow = `\nimport tensorflow as tf\nfrom tensorflow import keras\n\nmodel = keras.Sequential([\n    keras.layers.Dense(26, input_shape=(26,), activation='relu'),\n    keras.layers.Dense(15, activation='relu'),\n    keras.layers.Dense(1, activation='sigmoid')\n])\n\n# opt = keras.optimizers.Adam(learning_rate=0.01)\n\nmodel.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])\nmodel.fit(X_train, y_train, epochs=100)\n\nmodel.evaluate(X_test, y_test)\n\nyp = model.predict(X_test)\nyp[:5]\n`.trim();\n\nconst compiles = `\ny_pred = []\nfor element in yp:\n    if element > 0.5:\n        y_pred.append(1)\n    else:\n        y_pred.append(0)\n        \n        \ny_pred[:10]\ny_test[:10]\n\n\nfrom sklearn.metrics import confusion_matrix , classification_report\nprint(classification_report(y_test,y_pred))\n\nimport seaborn as sn\ncm = tf.math.confusion_matrix(labels=y_test,predictions=y_pred)\n\nplt.figure(figsize = (10,7))\nsn.heatmap(cm, annot=True, fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')\n\ny_test.shape\nround((862+229)/(862+229+137+179),2)                      #Accuracy\n`.trim();\n\nconst precision = `\nround(862/(862+179),2)\nround(229/(229+137),2)                             #Precision for 1 class. i.e.Precision for customers who actually churned.\n\nround(229/(229+137),2)\nround(862/(862+137),2)                             #Recall for 0 class.\n\nround(862/(862+137),2)\nround(229/(229+179),2)\n`.trim();\n\nconst childsFiles = `\nfrom matplotlib import pyplot as plt\nfrom sklearn.metrics import confusion_matrix , classification_report\nimport pandas as pd\n\ntruth = [\"Dog\",\"Not a dog\",\"Dog\",\"Dog\", \"Dog\", \"Not a dog\", \"Not a dog\", \"Dog\", \"Dog\", \"Not a dog\"]\nprediction = [\"Dog\",\"Dog\", \"Dog\",\"Not a dog\",\"Dog\", \"Not a dog\", \"Dog\", \"Not a dog\", \"Dog\", \"Dog\"]\n\ncm = confusion_matrix(truth,prediction)\nprint_confusion_matrix(cm,[\"Dog\",\"Not a dog\"])\n\nprint(classification_report(truth, prediction))\n\n2*(0.57*0.67/(0.57+0.67))                                                                 #f1 score for Dog class.\n2*(0.33*0.25/(0.33+0.25))                                                                 #f1 score for Not a dog class.\n`.trim();\n\nconst predictions = `\nPrecision =  True Positive(TP)/ (TP+FP)\n\nRecall = TP/ (TP + FN)\n`.trim();\n\n\nclass Customer extends Component {\n  componentDidMount() {\n    setTimeout(() => Prism.highlightAll(), 0)\n  }\n  render() {\n    const { classes } = this.props;\n    return (\n      <Grid container>\n        <Grid item xs={2}>\n          <Paper className={classes.paper}>\n            <h4><Sidebar /></h4>\n          </Paper>\n        </Grid>\n        <Grid item xs={10}>\n          <Paper className={classes.paper}>\n            <List>\n              <h3>Customer Churn Prediction Using Artificial Neural Network (ANN)</h3>\n              Neural networks/ ANNs/ simulated neural networks (SNNs), are a subset of ML and are at the heart of DL algorithms. Their name and structure\n              are inspired by the human brain, mimicking the way that biological neurons signal to one another.\n\n              <br />\n              <br />\n              <i>Customer churn prediction is to measure why customers are leaving a business.\n                we look customer churn in telecom business. We will build a deep learning model to predict\n                the churn and use precision,recall, f1-score to measure performance of our model.</i>\n              <br />\n              <br />\n              <div style={titles}>\n                <PrismCode\n                  code={childsFile}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n              <br />\n\n              <b>Quick glance at above makes me realize that TotalCharges should be float but it is an object.</b>\n              <br />\n              <br />\n              <div style={titles}>\n                <PrismCode\n                  code={realize}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3>Data Visualization</h3>\n              <div style={titles}>\n                <PrismCode\n                  code={visualization}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3>Many of the columns are yes, no etc. Print unique values in object columns to see data values</h3>\n              <div style={titles}>\n                <PrismCode\n                  code={columns}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3>Convert Yes and No to 1 or 0</h3>\n              <div style={titles}>\n                <PrismCode\n                  code={convert}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3>One hot encoding for categorical columns</h3>\n              <div style={titles}>\n                <PrismCode\n                  code={encoding}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3>Train test split</h3>\n              <div style={titles}>\n                <PrismCode\n                  code={split}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3>Build a model (ANN) in tensorflow/keras</h3>\n              <div style={titles}>\n                <PrismCode\n                  code={tensorflow}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n              <br />\n\n              <b>Precision for 0 class. i.e. Precision for customers who did not churn.</b>\n              <br />\n              <div style={titles}>\n                <PrismCode\n                  code={precision}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3></h3>\n              <div style={titles}>\n                <PrismCode\n                  code={tensorflow}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3>Precision Recall</h3>\n              <ul>\n                <li><b>Precision:</b>Is out of all Prediction how many got it right.</li>\n                <ul>\n                  <li>Think about Prediction as base.</li>\n                </ul>\n                <br />\n                <li><b>Recall:</b>Is out of all True how many got it right.</li>\n                <ul>\n                  <li>Think about truth is base.</li>\n                </ul>\n              </ul>\n              <br />\n              <div style={titles}>\n                <PrismCode\n                  code={predictions}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n              <br />\n\n              <div style={titles}>\n                <PrismCode\n                  code={childsFiles}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n            </List>\n          </Paper>\n        </Grid>\n      </Grid>\n    )\n  }\n}\n\n\nexport default (withStyles(styles)(Customer));\n"]},"metadata":{},"sourceType":"module"}