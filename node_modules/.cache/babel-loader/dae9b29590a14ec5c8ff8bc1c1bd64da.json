{"ast":null,"code":"var _jsxFileName = \"/home/mukeshs/Projects/edurights/src/components/angularjsd/angular 12/vote.js\";\nimport React, { Component } from 'react';\nimport Prism from \"prismjs\";\nimport { Grid, Paper, withStyles, List } from \"@material-ui/core\";\nimport '../../ReactJs/styles.css';\nimport Sidebar from '../sidebar';\nimport PrismCode from '../../ReactJs/prismCode';\nconst titles = {\n  backgroundColor: '#F0F8FF',\n  padding: '1px',\n  fontSize: '16px'\n};\n\nconst styles = theme => ({\n  paper: {\n    margin: theme.spacing(1),\n    padding: theme.spacing(1)\n  },\n  smMargin: {\n    margin: theme.spacing(1)\n  },\n  actionDiv: {\n    textAlign: \"center\"\n  }\n});\n\nconst vote = `\n//voter.component.ts\n@Component({\n  selector: 'app-voter',\n  template: '\n  <h4>{{name}}</h4>\n    <button (click) = \"vote(true)\" [disabled]=\"didVote\">Agree</button>\n    <button (click) = \"vote(false)\" [disabled]=\"didVote\">Disagree</button>\n  '\n})\nexport class VoterComponent {\n  @Input()  name = '';\n  @Output() voted = new EventEmitter<boolean>();\n  didVote = false;\n\n  vote(agreed: boolean) {\n    this.voted.emit(agreed);\n    this.didVote = true;\n  }\n}\n\n\n//votetaker.component.ts\n@Component({\n  selector: 'app-vote-taker',\n  template: '\n    <h2>Should mankind colonize the Universe?</h2>\n    <h3>Agree: {{agreed}}, Disagree: {{disagreed}}</h3>\n    <app-voter * ngFor=\"let voter of voters\" [name] = \"voter\"\n        (voted) = \"onVoted($event)\">\n    </app-voter>\n  '\n})\n\nexport class VoteTakerComponent {\n  agreed = 0;\n  disagreed = 0;\n  voters = ['Narco', 'Celeritas', 'Bombasto'];\n\n  onVoted(agreed: boolean) {\n    agreed ? this.agreed++ : this.disagreed++;\n  }\n}\n\n\n//app.component.ts\n@Component({\n  selector: 'app-root',\n  template: '\n    <a href = \"#child-to-parent\"> Parent listens for child event</a><br/>\n        <div id=\"child-to-parent\">\n          <app-vote-taker></app-vote-taker>\n        </div>\n        '})\n\nexport class AppComponent { }\n`.trim();\nconst liftOff = `\n//astronaut.component.ts\nimport { Component, Input, OnDestroy } from '@angular/core';\n\nimport { MissionService } from './mission.service';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-astronaut',\n  template: '\n    <p>\n      {{astronaut}}: <strong>{{mission}}</strong>\n      <button (click) = \"confirm()\" [disabled]=\"!announced || confirmed\">Confirm</button>\n    </p >\n  '\n})\nexport class AstronautComponent implements OnDestroy {\n  @Input() astronaut = '';\n  mission = '<no mission announced>';\n  confirmed = false;\n  announced = false;\n  subscription: Subscription;\n\n  constructor(private missionService: MissionService) {\n    this.subscription = missionService.missionAnnounced$.subscribe(\n      mission => {\n        this.mission = mission;\n        this.announced = true;\n        this.confirmed = false;\n    });\n  }\n\n  confirm() {\n    this.confirmed = true;\n    this.missionService.confirmMission(this.astronaut);\n  }\n\n  ngOnDestroy() {\n    // prevent memory leak when component destroyed\n    this.subscription.unsubscribe();\n  }\n}\n\n\n//countdown-parent.component.ts\nimport { AfterViewInit, ViewChild } from '@angular/core';\nimport { Component } from '@angular/core';\nimport { CountdownTimerComponent } from './countdown-timer.component';\n\n@Component({\n  selector: 'app-countdown-parent-lv',\n  template: '\n  <h3>Countdown to Liftoff (via local variable)</h3>\n    <button (click) = \"timer.start()\">Start</button>\n      <button (click) = \"timer.stop()\">Stop</button>\n    <div class=\"seconds\">{{timer.seconds}}</div>\n    <app-countdown-timer #timer></app-countdown-timer>\n',\n  styleUrls: ['../assets/demo.css']\n})\nexport class CountdownLocalVarParentComponent { }\n\n//// View Child version\n@Component({\n  selector: 'app-countdown-parent-vc',\n  template: '\n  <h3>Countdown to Liftoff(via ViewChild)</h3>\n      <button (click) =\"start()\">Start</button>\n      <button (click) =\"stop()\"> Stop</button>\n  <div class=\"seconds\">{{seconds()}}</div>\n  <app-countdown-timer></app-countdown-timer>\n  ',\n  styleUrls: ['../assets/demo.css']\n})\nexport class CountdownViewChildParentComponent implements AfterViewInit {\n\n  @ViewChild(CountdownTimerComponent)\n  private timerComponent!: CountdownTimerComponent;\n\n  seconds() { return 0; }\n\n  ngAfterViewInit() {\n    setTimeout(() => this.seconds = () => this.timerComponent.seconds, 0);\n  }\n\n  start() { this.timerComponent.start(); }\n  stop() { this.timerComponent.stop(); }\n}\n\n\n//countdown-timer.component.ts\nimport { Component, OnDestroy } from '@angular/core';\n\n@Component({\n  selector: 'app-countdown-timer',\n  template: '<p>{{message}}</p>'\n})\nexport class CountdownTimerComponent implements OnDestroy {\n\n  intervalId = 0;\n  message = '';\n  seconds = 11;\n\n  ngOnDestroy() {this.clearTimer();}\n\n  start() {this.countDown();}\n  stop()  {\n    this.clearTimer();\n    this.message = 'Holding at T-'$'{this.seconds} seconds';\n  }\n\n  private clearTimer() {clearInterval(this.intervalId);}\n\n  private countDown() {\n    this.clearTimer();\n    this.intervalId = window.setInterval(() => {\n      this.seconds -= 1;\n      if (this.seconds === 0) {\n        this.message = 'Blast off!';\n      } else {\n        if (this.seconds < 0) {this.seconds = 10;} // reset\n        this.message = 'T - '$'{this.seconds} seconds and counting';\n      }\n    }, 1000);\n  }\n}\n\n\n\n//missioncontrol.component.ts\nimport { MissionService } from './mission.service';\n\n@Component({\n  selector: 'app-mission-control',\n  template: '\n    <h2> Mission Control</h2>\n    <button (click) = \"announce()\"> Announce mission</button>\n      <app-astronaut ngFor=\"let astronaut of astronauts\" [astronaut]=\"astronaut\">\n    </app-astronaut >\n    <h3>History</h3>\n    <ul>\n      <li *ngFor=\"let event of history\">{{event}}</li>\n    </ul >\n  ',\n  providers: [MissionService]\n})\nexport class MissionControlComponent {\n  astronauts = ['Lovell', 'Swigert', 'Haise'];\n  history: string[] = [];\n  missions = ['Fly to the moon!', Fly to mars!', 'Fly to Vegas!'];\n  nextMission = 0;\n\n  constructor(private missionService: MissionService) {\n    missionService.missionConfirmed$.subscribe(\n      astronaut => {\n        this.history.push(''$'{astronaut} confirmed the mission');\n      });\n  }\n\n  announce() {\n    const mission = this.missions[this.nextMission++];\n    this.missionService.announceMission(mission);\n    this.history.push('Mission \"'$'{mission}\" announced');\n    if (this.nextMission >= this.missions.length) {this.nextMission = 0;}\n  }\n}\n\n\n//mission.service.ts\nimport { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\n\n@Injectable()\nexport class MissionService {\n\n  // Observable string sources\n  private missionAnnouncedSource = new Subject<string>();\n  private missionConfirmedSource = new Subject<string>();\n\n  // Observable string streams\n  missionAnnounced$ = this.missionAnnouncedSource.asObservable();\n  missionConfirmed$ = this.missionConfirmedSource.asObservable();\n\n  // Service message commands\n  announceMission(mission: string) {\n    this.missionAnnouncedSource.next(mission);\n  }\n\n  confirmMission(astronaut: string) {\n    this.missionConfirmedSource.next(astronaut);\n  }\n}\n`.trim();\n\nclass Vote extends Component {\n  componentDidMount() {\n    setTimeout(() => Prism.highlightAll(), 0);\n  }\n\n  render() {\n    const {\n      classes\n    } = this.props;\n    return React.createElement(Grid, {\n      container: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      xs: 2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, React.createElement(Paper, {\n      className: classes.paper,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }, React.createElement(Sidebar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    })))), React.createElement(Grid, {\n      item: true,\n      xs: 10,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, React.createElement(Paper, {\n      className: classes.paper,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }, React.createElement(List, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }, \"1. Vote\"), React.createElement(\"div\", {\n      style: titles,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, React.createElement(PrismCode, {\n      code: vote,\n      language: \"js\",\n      plugins: [\"line-numbers\"],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }), React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306\n      },\n      __self: this\n    }, \"2. Cutdown_liftoff\"), React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307\n      },\n      __self: this\n    }, \"countdown-parent.component\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308\n      },\n      __self: this\n    }), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }, \"It takes a bit more work to get the child view into the parent component class.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    }, \"First, you have to import references to the ViewChild decorator and the AfterViewInit lifecycle hook.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, \"Next, inject the child CountdownTimerComponent into the private timerComponent property using the @ViewChild property decoration.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, \"The #timer local variable is gone from the component metadata. Instead, bind the buttons to the parent component's own start and stop methods and present the ticking seconds in an interpolation around the parent component's seconds method.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    }, \"These methods access the injected timer component directly.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, \"The ngAfterViewInit() lifecycle hook is an important wrinkle. The timer component isn't available until after Angular displays the parent view. So it displays 0 seconds initially.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    }, \"Then Angular calls the ngAfterViewInit lifecycle hook at which time it is too late to update the parent view's display of the countdown seconds. Angular's unidirectional data flow rule prevents updating the parent view's in the same cycle. The application has to wait one turn before it can display the seconds.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    }, \"Use setTimeout() to wait one tick and then revise the seconds() method so that it takes future values from the timer component.\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }), React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328\n      },\n      __self: this\n    }, \"mission.service\"), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330\n      },\n      __self: this\n    }, \"A parent component and its children share a service whose interface enables bi-directional communication within the family.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332\n      },\n      __self: this\n    }, \"The scope of the service instance is the parent component and its children. Components outside this component subtree have no access to the service or their communications.\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334\n      },\n      __self: this\n    }, \"This MissionService connects the MissionControlComponent to multiple AstronautComponent children.\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336\n      },\n      __self: this\n    }), React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    }, \"MissionControl\"), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339\n      },\n      __self: this\n    }, \"The MissionControlComponent both provides the instance of the service that it shares with its children (through the providers metadata array) and injects that instance into itself through its constructor:\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, \"The AstronautComponent also injects the service in its constructor. Each AstronautComponent is a child of the MissionControlComponent and therefore receives its parent's service instance:\")), React.createElement(\"div\", {\n      style: titles,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344\n      },\n      __self: this\n    }, React.createElement(PrismCode, {\n      code: liftOff,\n      language: \"js\",\n      plugins: [\"line-numbers\"],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345\n      },\n      __self: this\n    }))))));\n  }\n\n}\n\nexport default withStyles(styles)(Vote);","map":{"version":3,"sources":["/home/mukeshs/Projects/edurights/src/components/angularjsd/angular 12/vote.js"],"names":["React","Component","Prism","Grid","Paper","withStyles","List","Sidebar","PrismCode","titles","backgroundColor","padding","fontSize","styles","theme","paper","margin","spacing","smMargin","actionDiv","textAlign","vote","trim","liftOff","Vote","componentDidMount","setTimeout","highlightAll","render","classes","props"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Prism from \"prismjs\"\nimport { Grid, Paper, withStyles, List } from \"@material-ui/core\";\n\nimport '../../ReactJs/styles.css'\nimport Sidebar from '../sidebar';\nimport PrismCode from '../../ReactJs/prismCode';\n\n\nconst titles = { backgroundColor: '#F0F8FF', padding: '1px', fontSize: '16px' }\n\nconst styles = theme => ({\n  paper: {\n    margin: theme.spacing(1),\n    padding: theme.spacing(1)\n  },\n  smMargin: {\n    margin: theme.spacing(1)\n  },\n  actionDiv: {\n    textAlign: \"center\"\n  }\n})\n\n\nconst vote = `\n//voter.component.ts\n@Component({\n  selector: 'app-voter',\n  template: '\n  <h4>{{name}}</h4>\n    <button (click) = \"vote(true)\" [disabled]=\"didVote\">Agree</button>\n    <button (click) = \"vote(false)\" [disabled]=\"didVote\">Disagree</button>\n  '\n})\nexport class VoterComponent {\n  @Input()  name = '';\n  @Output() voted = new EventEmitter<boolean>();\n  didVote = false;\n\n  vote(agreed: boolean) {\n    this.voted.emit(agreed);\n    this.didVote = true;\n  }\n}\n\n\n//votetaker.component.ts\n@Component({\n  selector: 'app-vote-taker',\n  template: '\n    <h2>Should mankind colonize the Universe?</h2>\n    <h3>Agree: {{agreed}}, Disagree: {{disagreed}}</h3>\n    <app-voter * ngFor=\"let voter of voters\" [name] = \"voter\"\n        (voted) = \"onVoted($event)\">\n    </app-voter>\n  '\n})\n\nexport class VoteTakerComponent {\n  agreed = 0;\n  disagreed = 0;\n  voters = ['Narco', 'Celeritas', 'Bombasto'];\n\n  onVoted(agreed: boolean) {\n    agreed ? this.agreed++ : this.disagreed++;\n  }\n}\n\n\n//app.component.ts\n@Component({\n  selector: 'app-root',\n  template: '\n    <a href = \"#child-to-parent\"> Parent listens for child event</a><br/>\n        <div id=\"child-to-parent\">\n          <app-vote-taker></app-vote-taker>\n        </div>\n        '})\n\nexport class AppComponent { }\n`.trim();\n\nconst liftOff = `\n//astronaut.component.ts\nimport { Component, Input, OnDestroy } from '@angular/core';\n\nimport { MissionService } from './mission.service';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-astronaut',\n  template: '\n    <p>\n      {{astronaut}}: <strong>{{mission}}</strong>\n      <button (click) = \"confirm()\" [disabled]=\"!announced || confirmed\">Confirm</button>\n    </p >\n  '\n})\nexport class AstronautComponent implements OnDestroy {\n  @Input() astronaut = '';\n  mission = '<no mission announced>';\n  confirmed = false;\n  announced = false;\n  subscription: Subscription;\n\n  constructor(private missionService: MissionService) {\n    this.subscription = missionService.missionAnnounced$.subscribe(\n      mission => {\n        this.mission = mission;\n        this.announced = true;\n        this.confirmed = false;\n    });\n  }\n\n  confirm() {\n    this.confirmed = true;\n    this.missionService.confirmMission(this.astronaut);\n  }\n\n  ngOnDestroy() {\n    // prevent memory leak when component destroyed\n    this.subscription.unsubscribe();\n  }\n}\n\n\n//countdown-parent.component.ts\nimport { AfterViewInit, ViewChild } from '@angular/core';\nimport { Component } from '@angular/core';\nimport { CountdownTimerComponent } from './countdown-timer.component';\n\n@Component({\n  selector: 'app-countdown-parent-lv',\n  template: '\n  <h3>Countdown to Liftoff (via local variable)</h3>\n    <button (click) = \"timer.start()\">Start</button>\n      <button (click) = \"timer.stop()\">Stop</button>\n    <div class=\"seconds\">{{timer.seconds}}</div>\n    <app-countdown-timer #timer></app-countdown-timer>\n',\n  styleUrls: ['../assets/demo.css']\n})\nexport class CountdownLocalVarParentComponent { }\n\n//// View Child version\n@Component({\n  selector: 'app-countdown-parent-vc',\n  template: '\n  <h3>Countdown to Liftoff(via ViewChild)</h3>\n      <button (click) =\"start()\">Start</button>\n      <button (click) =\"stop()\"> Stop</button>\n  <div class=\"seconds\">{{seconds()}}</div>\n  <app-countdown-timer></app-countdown-timer>\n  ',\n  styleUrls: ['../assets/demo.css']\n})\nexport class CountdownViewChildParentComponent implements AfterViewInit {\n\n  @ViewChild(CountdownTimerComponent)\n  private timerComponent!: CountdownTimerComponent;\n\n  seconds() { return 0; }\n\n  ngAfterViewInit() {\n    setTimeout(() => this.seconds = () => this.timerComponent.seconds, 0);\n  }\n\n  start() { this.timerComponent.start(); }\n  stop() { this.timerComponent.stop(); }\n}\n\n\n//countdown-timer.component.ts\nimport { Component, OnDestroy } from '@angular/core';\n\n@Component({\n  selector: 'app-countdown-timer',\n  template: '<p>{{message}}</p>'\n})\nexport class CountdownTimerComponent implements OnDestroy {\n\n  intervalId = 0;\n  message = '';\n  seconds = 11;\n\n  ngOnDestroy() {this.clearTimer();}\n\n  start() {this.countDown();}\n  stop()  {\n    this.clearTimer();\n    this.message = 'Holding at T-'$'{this.seconds} seconds';\n  }\n\n  private clearTimer() {clearInterval(this.intervalId);}\n\n  private countDown() {\n    this.clearTimer();\n    this.intervalId = window.setInterval(() => {\n      this.seconds -= 1;\n      if (this.seconds === 0) {\n        this.message = 'Blast off!';\n      } else {\n        if (this.seconds < 0) {this.seconds = 10;} // reset\n        this.message = 'T - '$'{this.seconds} seconds and counting';\n      }\n    }, 1000);\n  }\n}\n\n\n\n//missioncontrol.component.ts\nimport { MissionService } from './mission.service';\n\n@Component({\n  selector: 'app-mission-control',\n  template: '\n    <h2> Mission Control</h2>\n    <button (click) = \"announce()\"> Announce mission</button>\n      <app-astronaut ngFor=\"let astronaut of astronauts\" [astronaut]=\"astronaut\">\n    </app-astronaut >\n    <h3>History</h3>\n    <ul>\n      <li *ngFor=\"let event of history\">{{event}}</li>\n    </ul >\n  ',\n  providers: [MissionService]\n})\nexport class MissionControlComponent {\n  astronauts = ['Lovell', 'Swigert', 'Haise'];\n  history: string[] = [];\n  missions = ['Fly to the moon!', Fly to mars!', 'Fly to Vegas!'];\n  nextMission = 0;\n\n  constructor(private missionService: MissionService) {\n    missionService.missionConfirmed$.subscribe(\n      astronaut => {\n        this.history.push(''$'{astronaut} confirmed the mission');\n      });\n  }\n\n  announce() {\n    const mission = this.missions[this.nextMission++];\n    this.missionService.announceMission(mission);\n    this.history.push('Mission \"'$'{mission}\" announced');\n    if (this.nextMission >= this.missions.length) {this.nextMission = 0;}\n  }\n}\n\n\n//mission.service.ts\nimport { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\n\n@Injectable()\nexport class MissionService {\n\n  // Observable string sources\n  private missionAnnouncedSource = new Subject<string>();\n  private missionConfirmedSource = new Subject<string>();\n\n  // Observable string streams\n  missionAnnounced$ = this.missionAnnouncedSource.asObservable();\n  missionConfirmed$ = this.missionConfirmedSource.asObservable();\n\n  // Service message commands\n  announceMission(mission: string) {\n    this.missionAnnouncedSource.next(mission);\n  }\n\n  confirmMission(astronaut: string) {\n    this.missionConfirmedSource.next(astronaut);\n  }\n}\n`.trim();\n\n\n\nclass Vote extends Component {\n  componentDidMount() {\n    setTimeout(() => Prism.highlightAll(), 0)\n  }\n  render() {\n    const { classes } = this.props;\n    return (\n      <Grid container>\n        <Grid item xs={2}>\n          <Paper className={classes.paper}>\n            <h4><Sidebar /></h4>\n          </Paper>\n        </Grid>\n        <Grid item xs={10}>\n          <Paper className={classes.paper}>\n            <List>\n              <h3>1. Vote</h3>\n              <div style={titles}>\n                <PrismCode\n                  code={vote}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n              <br />\n\n              <h3>2. Cutdown_liftoff</h3>\n              <b>countdown-parent.component</b>\n              <br />\n              <ul>\n                <li>It takes a bit more work to get the child view into the parent component class.</li>\n                <li>First, you have to import references to the ViewChild decorator and the AfterViewInit lifecycle hook.\n                </li>\n                <li>Next, inject the child CountdownTimerComponent into the private timerComponent property using the @ViewChild\n                  property decoration.</li>\n                <li>The #timer local variable is gone from the component metadata. Instead, bind the buttons to the parent component's\n                  own start and stop methods and present the ticking seconds in an interpolation around the parent component's seconds\n                  method.</li>\n                <li>These methods access the injected timer component directly.</li>\n                <li>The ngAfterViewInit() lifecycle hook is an important wrinkle. The timer component isn't available until after\n                  Angular displays the parent view. So it displays 0 seconds initially.</li>\n                <li>Then Angular calls the ngAfterViewInit lifecycle hook at which time it is too late to update the parent view's\n                  display of the countdown seconds. Angular's unidirectional data flow rule prevents updating the parent view's in the\n                  same cycle. The application has to wait one turn before it can display the seconds.</li>\n                <li>Use setTimeout() to wait one tick and then revise the seconds() method so that it takes future values from the timer\n                  component.</li>\n              </ul>\n              <br />\n              <b>mission.service</b>\n              <ul>\n                <li>A parent component and its children share a service whose interface enables bi-directional communication within the\n                  family.</li>\n                <li>The scope of the service instance is the parent component and its children. Components outside this component subtree have\n                  no access to the service or their communications.</li>\n                <li>This MissionService connects the MissionControlComponent to multiple AstronautComponent children.</li>\n              </ul>\n              <br />\n              <b>MissionControl</b>\n              <ul>\n                <li>The MissionControlComponent both provides the instance of the service that it shares with its children (through the\n                  providers metadata array) and injects that instance into itself through its constructor:</li>\n                <li>The AstronautComponent also injects the service in its constructor. Each AstronautComponent is a child of the\n                  MissionControlComponent and therefore receives its parent's service instance:</li>\n              </ul>\n              <div style={titles}>\n                <PrismCode\n                  code={liftOff}\n                  language=\"js\"\n                  plugins={[\"line-numbers\"]}\n                />\n              </div>\n            </List>\n          </Paper>\n        </Grid>\n      </Grid>\n    )\n  }\n}\n\nexport default (withStyles(styles)(Vote));\n"]},"metadata":{},"sourceType":"module"}